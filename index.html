<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- End Required meta tags -->
    <!-- Begin SEO tag -->
    <title>星图</title>
    <meta property="og:title" content="星图">
    <meta name="author" content="Orange">
    <meta property="og:locale" content="en_US">
    <meta name="description" content="星图">
    <meta property="og:description" content="星图">
    <link rel="canonical" href="index.html">
    <meta property="og:url" content="//nastoken.info">
    <meta property="og:site_name" content="星图">
    <script type="application/ld+json">
      {
        "name": "星图",
        "description": "星图",
        "author":
        {
          "@type": "Organization",
          "name": "Orange"
        },
        "@type": "WebSite",
        "url": "",
        "headline": "星图",
        "@context": "https://nasticker.com"
      }
    </script>
    <!-- End SEO tag -->
    <!-- FAVICONS -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/apple-touch-icon.png">
    <link rel="shortcut icon" href="assets/favicon.png">
    <meta name="theme-color" content="#3063A0">
    <!-- End FAVICONS -->

    <script src="assets/vendor/pace/pace.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/nebulas@0.5.2/dist/nebulas.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/nebulasio/nebPay@60c65f8a7e26015bb31c56d56f3a638a33ea3c8e/dist/nebPay.min.js"></script>
    <script src="assets/javascript/blockies.min.js"></script>
    <script src="assets/javascript/hqx.js"></script>
    <script src="assets/javascript/mustache.min.js"></script>
    <script src="assets/javascript/bignumber.min.js"></script>
    <script src="assets/javascript/config.js"></script>

    <!-- BEGIN BASE STYLES -->
    <link rel="stylesheet" href="assets/vendor/pace/pace.min.css">
    <link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/vendor/open-iconic/css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="assets/vendor/font-awesome/css/fontawesome-all.min.css">
    <!-- END BASE STYLES -->
    <!-- BEGIN PLUGINS STYLES -->
    <link rel="stylesheet" href="assets/vendor/flatpickr/flatpickr.min.css">
    <!-- END PLUGINS STYLES -->
    <!-- BEGIN THEME STYLES -->
    <link rel="stylesheet" href="assets/vendor/toastr/toastr.min.css">
    <link rel="stylesheet" href="assets/stylesheets/main.min.css">
    <link rel="stylesheet" href="assets/stylesheets/custom.css">
    <!-- END THEME STYLES -->

  </head>
  <body>
    <!-- .app -->
    <div class="app has-fullwidth">
      <!-- .app-header -->
      <header class="app-header">
        <!-- .top-bar -->
        <div class="top-bar">
          <!-- .top-bar-brand -->
          <div class="top-bar-brand">
            <!-- toggle menu -->
            <button class="hamburger hamburger-squeeze mr-2" type="button" data-toggle="aside" aria-label="Menu" aria-controls="navigation">
              <span class="hamburger-box">
                <span class="hamburger-inner"></span>
              </span>
            </button>
            <!-- /toggle menu -->
            <a href="index.html">
              <img src="assets/images/brand-inverse.png" height="32" alt="">
            </a>
          </div>
          <!-- /.top-bar-brand -->
          <!-- .top-bar-list -->
          <div class="top-bar-list">
            <!-- .top-bar-item -->
            <div class="top-bar-item px-2 d-md-none d-lg-none d-xl-none">
              <!-- toggle menu -->
              <button class="hamburger hamburger-squeeze" type="button" data-toggle="aside" aria-label="Menu" aria-controls="navigation">
                <span class="hamburger-box">
                  <span class="hamburger-inner"></span>
                </span>
              </button>
              <!-- /toggle menu -->
            </div>
            <!-- /.top-bar-item -->
            <!-- .top-bar-item -->
            <div class="top-bar-item top-bar-item-full">
              <!-- .top-bar-search -->
              <div class="top-bar-search">
                <div class="input-group input-group-search">
                  <div class="input-group-prepend">
                    <span class="input-group-text">
                      <span class="oi oi-magnifying-glass"></span>
                    </span>
                  </div>
                  <input type="text" class="form-control" aria-label="Search" placeholder="搜索"> </div>
              </div>
              <!-- /.top-bar-search -->
            </div>
            <!-- /.top-bar-item -->
            <!-- .top-bar-item -->

            <div class="top-bar-item top-bar-item-right px-0 d-none d-sm-flex">
              <!-- .nav -->
              <ul class="header-nav nav">
                <li class="nav-item dropdown header-nav-dropdown has-notified">
                  <a class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="oi oi-envelope-open"></span>
                  </a>
                  <div class="dropdown-arrow"></div>
                  <!-- .dropdown-menu -->
                  <div class="dropdown-menu dropdown-menu-rich dropdown-menu-right">
                    <h6 class="dropdown-header stop-propagation">
                      <span>代币转账消息</span>
                    </h6>
                    <!-- .dropdown-scroll -->
                    <div class="dropdown-scroll has-scrollable" id="message">
                      <!-- .dropdown-item -->
                      <a class="dropdown-item unread">
                        <div class="user-avatar">
                          <img src="assets/images/avatars/team1.jpg" alt=""> </div>
                        <div class="dropdown-item-body">
                          <p class="subject"> CGT转账 </p>
                          <p class="text text-truncate"> 转账20CGT到 n1N7RTHqYBysTeqNT85akGxk27QRvPz4ctu </p>
                          <span class="date">2分钟前</span>
                        </div>
                      </a>

                      <!-- /.dropdown-item -->
                    </div>
                    <!-- /.dropdown-scroll -->
                    <a href="#" class="dropdown-footer">查看代币转账记录
                      <i class="fa fa-fw fa-long-arrow-alt-right"></i>
                    </a>
                  </div>
                  <!-- /.dropdown-menu -->
                </li>
                <!-- /.nav-item -->
                <!-- .nav-item -->
                <!--<li class="nav-item dropdown header-nav-dropdown">-->
                  <!--<a class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-->
                    <!--<span class="oi oi-grid-three-up"></span>-->
                  <!--</a>-->
                  <!--<div class="dropdown-arrow"></div>-->
                  <!--&lt;!&ndash; .dropdown-menu &ndash;&gt;-->
                  <!--<div class="dropdown-menu dropdown-menu-rich dropdown-menu-right">-->
                    <!--&lt;!&ndash; .dropdown-sheets &ndash;&gt;-->
                    <!--<div class="dropdown-sheets">-->
                      <!--&lt;!&ndash; .dropdown-sheet-item &ndash;&gt;-->
                      <!--<div class="dropdown-sheet-item">-->
                        <!--<a class="tile-wrapper">-->
                          <!--<span class="tile tile-lg bg-indigo">-->
                            <!--<i class="oi oi-people"></i>-->
                          <!--</span>-->
                          <!--<span class="tile-peek">注册星图用户</span>-->
                        <!--</a>-->
                      <!--</div>-->
                      <!--&lt;!&ndash; /.dropdown-sheet-item &ndash;&gt;-->
                      <!--&lt;!&ndash; .dropdown-sheet-item &ndash;&gt;-->
                      <!--<div class="dropdown-sheet-item">-->
                        <!--<a class="tile-wrapper">-->
                          <!--<span class="tile tile-lg bg-teal">-->
                            <!--<i class="oi oi-tags"></i>-->
                          <!--</span>-->
                          <!--<span class="tile-peek">注册星星</span>-->
                        <!--</a>-->
                      <!--</div>-->
                      <!--&lt;!&ndash; /.dropdown-sheet-item &ndash;&gt;-->
                      <!--&lt;!&ndash; .dropdown-sheet-item &ndash;&gt;-->
                      <!--<div class="dropdown-sheet-item">-->
                        <!--<a class="tile-wrapper">-->
                          <!--<span class="tile tile-lg bg-pink">-->
                            <!--<i class="fa fa-code"></i>-->
                          <!--</span>-->
                          <!--<span class="tile-peek">新河挖矿</span>-->
                        <!--</a>-->
                      <!--</div>-->
                      <!--&lt;!&ndash; /.dropdown-sheet-item &ndash;&gt;-->
                      <!--&lt;!&ndash; .dropdown-sheet-item &ndash;&gt;-->
                      <!--<div class="dropdown-sheet-item">-->
                        <!--<a class="tile-wrapper">-->
                          <!--<span class="tile tile-lg bg-yellow">-->
                            <!--<i class="oi oi-fire"></i>-->
                          <!--</span>-->
                          <!--<span class="tile-peek">超级星图用户</span>-->
                        <!--</a>-->
                      <!--</div>-->
                      <!--&lt;!&ndash; /.dropdown-sheet-item &ndash;&gt;-->
                      <!--&lt;!&ndash; .dropdown-sheet-item &ndash;&gt;-->
                      <!--<div class="dropdown-sheet-item">-->
                        <!--<a class="tile-wrapper">-->
                          <!--<span class="tile tile-lg bg-cyan">-->
                            <!--<i class="oi oi-circle-check"></i>-->
                          <!--</span>-->
                          <!--<span class="tile-peek">站台星星</span>-->
                        <!--</a>-->
                      <!--</div>-->
                      <!--&lt;!&ndash; /.dropdown-sheet-item &ndash;&gt;-->
                    <!--</div>-->
                    <!--&lt;!&ndash; .dropdown-sheets &ndash;&gt;-->
                  <!--</div>-->
                  <!--&lt;!&ndash; .dropdown-menu &ndash;&gt;-->
                <!--</li>-->
                <!-- /.nav-item -->
              </ul>
              <!-- /.nav -->
              <!-- .btn-account -->
              <div class="dropdown">
                <button class="btn-account d-none d-md-flex" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <span class="user-avatar">
                    <!-- <img src="assets/images/avatars/uifaces0.jpg" alt="" class="avatarImg"> -->
                    <img id="roundIcon" class="avatarImg">
                  </span>
                  <span class="account-summary pr-lg-4 d-none d-lg-block">
                    <span class="account-name user-name">星图用户 #</span>
                    <span class="badge badge-pill badge-success network-state"> </span>
                  </span>
                </button>
                <div class="dropdown-arrow dropdown-arrow-left"></div>
                <!-- .dropdown-menu -->
                <div class="dropdown-menu">
                  <h6 class="dropdown-header d-none d-md-block d-lg-none user-name"> 星图用户 # </h6>
                  <button class="dropdown-item">
                    <span class="dropdown-icon oi oi-dollar"></span> NAS余额 <b class="accountBalance"></b></button>
                  <button class="dropdown-item">
                    <span class="dropdown-icon oi oi-dollar"></span> NTT余额 <b class="accountTokenBalance"></b></button>
                  <div class="dropdown-divider"></div>
                  <button class="dropdown-item" onclick="login()">
                    <span class="dropdown-icon oi oi-account-login"></span> 登陆</button>
                </div>
                <!-- /.dropdown-menu -->
              </div>
              <!-- /.btn-account -->
            </div>
            <!-- /.top-bar-item -->
          </div>
          <!-- /.top-bar-list -->
        </div>
        <!-- /.top-bar -->
      </header>
      <!-- /.app-header -->
      <!-- .app-aside -->
      <aside class="app-aside">
        <!-- .aside-content -->
        <div class="aside-content">
          <!-- .aside-header -->
          <header class="aside-header">
            <!-- toggle menu -->
            <button class="hamburger hamburger-squeeze" type="button" data-toggle="aside" aria-label="Menu" aria-controls="navigation">
              <span class="hamburger-box">
                <span class="hamburger-inner"></span>
              </span>
            </button>
            <!-- /toggle menu -->
            <!-- .btn-account -->
            <button class="btn-account d-flex d-md-none" type="button" data-toggle="collapse" data-target="#dropdown-aside">
              <span class="user-avatar user-avatar-lg">
                <!-- <img src="assets/images/avatars/uifaces0.jpg" alt="" class="avatarImg"> -->
                <img id="roundIcon" class="avatarImg">
              </span>
              <span class="account-icon">
                <span class="fa fa-caret-down fa-lg"></span>
              </span>
              <span class="account-summary">
                <span class="account-name user-name">星图用户 #</span>
                <span class="badge badge-pill badge-success network-state"> </span>
              </span>
            </button>
            <!-- /.btn-account -->
            <!-- .dropdown-aside -->
            <div id="dropdown-aside" class="dropdown-aside collapse">
              <!-- dropdown-items -->

              <div class="dropdown-menu">
                <h6 class="dropdown-header d-none d-md-block d-lg-none user-name"> 星图用户 # </h6>
                <button class="dropdown-item">
                  <span class="dropdown-icon oi oi-dollar"></span> NAS余额 <b class="accountBalance"></b></button>
                <button class="dropdown-item">
                  <span class="dropdown-icon oi oi-dollar"></span> NTT余额 <b class="accountTokenBalance"></b></button>
                <div class="dropdown-divider"></div>
                <button class="dropdown-item" onclick="login(true)">
                  <span class="dropdown-icon oi oi-account-login"></span> 登陆</button>
                <a class="dropdown-item" onclick="login(false)">
                  <span class="dropdown-icon oi oi-account-login"></span> 注册</a>
              </div>

              <div class="pb-3">
                <a class="dropdown-item">
                  <span class="dropdown-icon oi oi-dollar"></span> NAS余额 <b class="accountBalance"></b></a>
                <a class="dropdown-item">
                  <span class="dropdown-icon oi oi-dollar"></span> NTT余额 <b class="accountTokenBalance"></b></a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" onclick="login(true)">
                  <span class="dropdown-icon oi oi-account-login"></span> 登陆</a>
                <a class="dropdown-item" onclick="login(false)">
                  <span class="dropdown-icon oi oi-account-login"></span> 注册</a>
              </div>
              <!-- /dropdown-items -->
            </div>
            <!-- /.dropdown-aside -->
            <!-- .top-bar-brand -->
            <div class="top-bar-brand">
              <a href="index.html">
                <img src="assets/images/brand.png" height="32" alt="">
              </a>
            </div>
            <!-- /.top-bar-brand -->
          </header>
          <!-- /.aside-header -->
          <!-- .aside-menu -->
          <section class="aside-menu has-scrollable">
            <!-- .stacked-menu -->
            <nav id="stacked-menu" class="stacked-menu">
              <!-- .menu -->
              <ul class="menu">
                <!-- .menu-item -->
                <li class="menu-item">
                  <a href="index.html" class="menu-link">
                    <span class="menu-icon oi oi-dashboard"></span>
                    <span class="menu-text">Dashboard</span>
                  </a>
                </li>
                <!-- /.menu-item -->
                <!-- .menu-header -->
                <li class="menu-header">星星市场</li>

                <!-- /.menu-item -->
                <!-- .menu-item -->
                <li class="menu-item has-child">
                  <a href="#" class="menu-link">
                    <span class="menu-icon oi oi-grid-two-up"></span>
                    <span class="menu-text">所有代币</span>
                  </a>
                  <!-- child menu -->
                  <ul class="menu">
                    <li class="menu-item">
                      <a href="#" class="menu-link">优质代币</a>
                    </li>
                    <li class="menu-item">
                      <a href="#" class="menu-link">普通代币</a>
                    </li>
                  </ul>
                  <!-- /child menu -->
                </li>

                <!-- /.menu-item -->
                <!-- .menu-header -->
                <li class="menu-header">相关资源</li>
                <!-- /.menu-header -->
                <!-- .menu-item -->
                <!-- /.menu-item -->
                <!-- .menu-item -->
                <li class="menu-item has-child">
                  <a class="menu-link">
                    <span class="menu-icon oi oi-infinity"></span>
                    <span class="menu-text">官方资源</span>
                  </a>
                  <!-- child menu -->
                  <ul class="menu">
                    <li class="menu-item">
                      <a href="https://nebulas.io" target="_blank" class="menu-link">星云官方网站</a>
                    </li>
                    <li class="menu-item">
                      <a href="https://explorer.nebulas.io/#/" target="_blank" class="menu-link">星云区块浏览器</a>
                    </li>
                    <li class="menu-item">
                      <a href="https://github.com/nebulasio/WebExtensionWallet" target="_blank" class="menu-link">浏览器插件钱包</a>
                    </li>
                    <li class="menu-item">
                      <a href="https://nano.nebulas.io/" target="_blank" class="menu-link">移动端钱包</a>
                    </li>
                  </ul>
                  <!-- /child menu -->
                </li>

                <li class="menu-item has-child">
                  <a class="menu-link">
                    <span class="menu-icon oi oi-infinity"></span>
                    <span class="menu-text">社区资源</span>
                  </a>
                  <!-- child menu -->
                  <ul class="menu">
                    <li class="menu-item">
                      <a href="https://nas.me" target="_blank" class="menu-link">地址代号NAS.ME</a>
                    </li>
                    <li class="menu-item">
                      <a href="http://nasid.pro/" target="_blank" class="menu-link">NasId</a>
                    </li>
                    <li class="menu-item">
                      <a href="https://github.com/dabdevelop/nastokenticker" target="_blank" class="menu-link">项目GitHub源码</a>
                    </li>
                    <li class="menu-item">
                      <a target="_blank" class="menu-link" id="contract">合约地址</a>
                    </li>
                  </ul>
                  <!-- /child menu -->
                </li>
                <!-- /.menu-item -->
              </ul>
              <!-- /.menu -->
            </nav>
            <!-- /.stacked-menu -->
          </section>
          <!-- /.aside-menu -->
        </div>
        <!-- /.aside-content -->
      </aside>
      <!-- /.app-aside -->
      <!-- .app-main -->
      <main class="app-main">
        <!-- .wrapper -->
          <!-- .page -->
          <div class="page">
            <!-- .page-inner -->
            <div class="page-inner">
              <div class="page-section">
                <!-- .section-block -->
                <div class="section-block">
                  <!-- metric row -->
                  <div class="metric-row">
                    <div class="col-lg-9">
                      <div class="metric-row metric-flush">
                        <!-- metric column -->
                        <div class="col">
                          <!-- .metric -->
                          <div class="metric metric-bordered align-items-center">
                            <h2 class="metric-label"> 星图用户 </h2>
                            <p class="metric-value h3">
                              <sub>
                                <i class="oi oi-people"></i>
                              </sub>
                              <span class="value" id="holderNum">0</span>
                            </p>
                          </div>
                          <!-- /.metric -->
                        </div>
                        <!-- /metric column -->
                        <!-- metric column -->
                        <div class="col">
                          <!-- .metric -->
                          <div class="metric metric-bordered align-items-center">
                            <h2 class="metric-label"> 代币总数 </h2>
                            <p class="metric-value h3">
                              <sub>
                                <i class="oi oi-book"></i>
                              </sub>
                              <span class="value" id="tokenNum">0</span>
                            </p>
                          </div>
                          <!-- /.metric -->
                        </div>
                        <!-- /metric column -->
                        <!-- metric column -->
                        <div class="col">
                          <!-- .metric -->
                          <div class="metric metric-bordered align-items-center">
                            <h2 class="metric-label"> 持有代币 </h2>
                            <p class="metric-value h3">
                              <sub>
                                <i class="fa fa-bookmark"></i>
                              </sub>
                              <span class="value" id="ownToken">0</span>
                            </p>
                          </div>
                          <!-- /.metric -->
                        </div>
                        <!-- /metric column -->
                      </div>
                    </div>
                    <!-- metric column -->
                    <div class="col-lg-3">
                      <!-- .metric -->
                      <div class="metric metric-bordered align-items-center">
                        <div class="metric-badge">
                          <span class="badge badge-lg badge-success">
                            <span class="oi oi-dollar pulse mr-1"></span> 代币资产(NAS) </span>
                        </div>
                        <p class="metric-value h3">
                          <sub>
                            <i class="oi oi-timer"></i>
                          </sub>
                          <span class="value" id="capital">0</span>
                        </p>
                      </div>
                      <!-- /.metric -->
                    </div>
                    <!-- /metric column -->
                  </div>
                  <!-- /metric row -->
                </div>

                <div class="page-section">
                  <div class="masonry-layout">

                    <div class="masonry-item col-lg-6">
                      <section class="card card-fluid">
                        <img src="assets/images/dummy/img-8.jpg" alt="" class="card-img-top img-fluid">
                        <div class="card-body pt-2">
                          <div class="media mb-3">
                            <a href="https://cgplayerone.com/" target="_blank" class="user-avatar user-avatar-floated user-avatar-xl float-left mr-3">
                              <img src="assets/images/logos/cgt.png">
                            </a>
                            <div class="media-body">
                              <h3 class="card-title text-truncate">
                                <a href="https://explorer.nebulas.io/#/address/n1sr4JA4e9QPB4opLk2Kjmp8NkP6GGoAmnt#/" target="_blank">CGT</a>
                                <i class="oi oi-star"></i>
                              </h3>
                              <h6 class="card-subtitle text-muted">头玩币</h6>
                            </div>

                            <div class="btn-group" role="group" aria-label="操作">
                              <button type="button" class="btn btn-xs btn-outline-primary" onclick="authDialog('n1sr4JA4e9QPB4opLk2Kjmp8NkP6GGoAmnt')">站台</button>
                              <button type="button" class="btn btn-xs btn-outline-primary" onclick="popDialog('n1sr4JA4e9QPB4opLk2Kjmp8NkP6GGoAmnt')">支持</button>
                              <button type="button" class="btn btn-xs btn-outline-primary" onclick="transferDialog('n1sr4JA4e9QPB4opLk2Kjmp8NkP6GGoAmnt')">转账</button>
                            </div>
                          </div>
                          <div class="row text-center">
                            <div class="col">
                              <div class="metric">
                                <h6 class="metric-value" id="authToken0">0</h6>
                                <p class="metric-label">站台</p>
                              </div>
                            </div>
                            <div class="col">
                              <div class="metric">
                                <h6 class="metric-value" id="popToken0">0</h6>
                                <p class="metric-label">支持</p>
                              </div>
                            </div>
                            <div class="col">
                              <div class="metric">
                                <h6 class="metric-value" id="balanceToken0">0</h6>
                                <p class="metric-label">余额</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </section>
                    </div>

                    <div class="masonry-item col-lg-6">
                      <section class="card card-fluid">
                        <img src="assets/images/dummy/img-8.jpg" alt="" class="card-img-top img-fluid">
                        <div class="card-body pt-2">
                          <div class="media mb-3">
                            <a href="https://nasticker.com/" class="user-avatar user-avatar-floated user-avatar-xl float-left mr-3">
                              <img src="assets/images/logos/ntt.png">
                            </a>
                            <div class="media-body">
                              <h3 class="card-title text-truncate">
                                <a href="https://explorer.nebulas.io/#/address/n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr#/" target="_blank">NTT</a>
                                <i class="oi oi-star"></i>
                              </h3>
                              <h6 class="card-subtitle text-muted">星图币</h6>
                            </div>
                            <div class="btn-group" role="group" aria-label="操作">
                              <button type="button" class="btn btn-xs btn-outline-primary" onclick="authDialog('n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr')">站台</button>
                              <button type="button" class="btn btn-xs btn-outline-primary" onclick="popDialog('n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr')">支持</button>
                              <button type="button" class="btn btn-xs btn-outline-primary" onclick="transferDialog('n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr')">转账</button>
                            </div>
                          </div>
                          <div class="row text-center">
                            <div class="col">
                              <div class="metric">
                                <h6 class="metric-value" id="authToken1">0</h6>
                                <p class="metric-label">站台</p>
                              </div>
                            </div>
                            <div class="col">
                              <div class="metric">
                                <h6 class="metric-value" id="popToken1">0</h6>
                                <p class="metric-label">支持</p>
                              </div>
                            </div>
                            <div class="col">
                              <div class="metric">
                                <h6 class="metric-value" id="balanceToken1">0</h6>
                                <p class="metric-label">余额</p>
                              </div>
                            </div>
                          </div>
                        </div>
                      </section>
                    </div>



                    <!--<div class="masonry-item col-lg-6">-->
                      <!--<section class="card card-fluid">-->
                        <!--<img src="assets/images/dummy/img-8.jpg" alt="" class="card-img-top img-fluid">-->
                        <!--<div class="card-body pt-2">-->
                          <!--<div class="media mb-3">-->
                            <!--<a href="https://nas.cryptohero.pro" class="user-avatar user-avatar-floated user-avatar-xl float-left mr-3">-->
                              <!--<img src="assets/images/logos/ntt.png">-->
                            <!--</a>-->
                            <!--<div class="media-body">-->
                              <!--<h3 class="card-title text-truncate">-->
                                <!--<a href="https://explorer.nebulas.io/#/address/n1gDfiiQLEBu95xDWHGxNi4qToyXjD2vE4D#/" target="_blank">WMT</a>-->
                                <!--<i class="oi oi-star"></i>-->
                              <!--</h3>-->
                              <!--<h6 class="card-subtitle text-muted">水浒币</h6>-->
                            <!--</div>-->
                            <!--<div class="btn-group" role="group" aria-label="操作">-->
                              <!--<button type="button" class="btn btn-xs btn-outline-primary" onclick="authDialog('n1gDfiiQLEBu95xDWHGxNi4qToyXjD2vE4D')">站台</button>-->
                              <!--<button type="button" class="btn btn-xs btn-outline-primary" onclick="popDialog('n1gDfiiQLEBu95xDWHGxNi4qToyXjD2vE4D')">支持</button>-->
                              <!--<button type="button" class="btn btn-xs btn-outline-primary" onclick="transferDialog('n1gDfiiQLEBu95xDWHGxNi4qToyXjD2vE4D')">转账</button>-->
                            <!--</div>-->
                          <!--</div>-->
                          <!--<div class="row text-center">-->
                            <!--<div class="col">-->
                              <!--<div class="metric">-->
                                <!--<h6 class="metric-value" id="authToken2">0</h6>-->
                                <!--<p class="metric-label">站台</p>-->
                              <!--</div>-->
                            <!--</div>-->
                            <!--<div class="col">-->
                              <!--<div class="metric">-->
                                <!--<h6 class="metric-value" id="popToken2">0</h6>-->
                                <!--<p class="metric-label">支持</p>-->
                              <!--</div>-->
                            <!--</div>-->
                            <!--<div class="col">-->
                              <!--<div class="metric">-->
                                <!--<h6 class="metric-value" id="balanceToken2">0</h6>-->
                                <!--<p class="metric-label">余额</p>-->
                              <!--</div>-->
                            <!--</div>-->
                          <!--</div>-->
                        <!--</div>-->
                      <!--</section>-->
                    <!--</div>-->


                  <hr>
                  <!-- /grid row -->
                </div>
              </div>
              <!-- /.page-section -->
            </div>
            <!-- /.page-inner -->
          </div>
          <!-- /.page -->
        </div>
        <!-- /.wrapper -->
      </main>
      <!-- /.app-main -->
    </div>
    <!-- /.app -->
    <!-- BEGIN BASE JS -->
    <script src="assets/vendor/jquery/jquery.min.js"></script>
    <script src="assets/vendor/bootstrap/js/popper.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.min.js"></script>
    <!-- END BASE JS -->
    <!-- BEGIN PLUGINS JS -->
    <script src="assets/vendor/stacked-menu/stacked-menu.min.js"></script>
    <script src="assets/vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
    <script src="assets/vendor/flatpickr/flatpickr.min.js"></script>
    <script src="assets/vendor/jquery.easy-pie-chart/jquery.easypiechart.min.js"></script>
    <script src="assets/vendor/chart.js/Chart.min.js"></script>
    <!-- END PLUGINS JS -->
    <!-- BEGIN THEME JS -->
    <script src="assets/javascript/main.min.js"></script>
    <script src="assets/vendor/toastr/toastr.min.js"></script>
    <script>

      var toastBot = {
        init: function init() {
          this.bindUIActions();
        },
        bindUIActions: function bindUIActions() {
          toastr.options.positionClass = 'toast-top-right';
          toastr.options.closeButton = true;
          toastr.options.progressBar = true;
          toastr.options.extendedTimeOut = 0; //1000
          toastr.options.timeOut = 3000;
          toastr.options.fadeOut = 250;
          toastr.options.fadeIn = 250;
        },
        showToast: function showToast(type, msg, position) {
          if(position === '' || position == null)
            position = 'toast-top-right';
          toastr.options.positionClass = position;
          toastr[type](msg);
        }
      };
      toastBot.init();

      'use strict';

      var Nebulas = require("nebulas");
      var Account = Nebulas.Account;
      var Transaction = Nebulas.Transaction;
      var Utils = Nebulas.Utils;
      var Unit = Nebulas.Unit;

//      var rpcURL = "https://testnet.nebulas.io";
//      var dappAddress = 'n1zNr21Y4jzFGgeYnAe5aXjfTHq1cNxjUex';
//      var chainId = 1001;
//      var rpcURL = "http://localhost:8685";
      var rpcURL = "https://mainnet.nebulas.io";
      var chainId = 1;
      var dappAddress = 'n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr';

      if(chainId == 1){
        $("#contract").prop('href','https://explorer.nebulas.io/#/address/'+ dappAddress +'#/').prop('target', '_blank_');
      } else {
        $("#contract").prop('href','https://explorer.nebulas.io/#/testnet/address/'+ dappAddress +'#/').prop('target', '_blank_');
      }

      var neb = new Nebulas.Neb();
      neb.setRequest(new Nebulas.HttpRequest(rpcURL));

      var needCheckNASWallet = localStorage.getItem('needCheckNASWallet') || '1';
      needCheckNASWallet = parseInt(needCheckNASWallet);
      var invoker = null;

      function checkNASWallet(_invoker) {
        invoker = _invoker;
        //to check if the extension is installed
        //if the extension is installed, var "webExtensionWallet" will be injected in to web page
        if (needCheckNASWallet && (typeof (webExtensionWallet) === "undefined")) {
          $(document).ready(function () {
            if(window.mobileAndTabletcheck()){
              toastBot.showToast('warning', "在移动端请安装使用NAS nano!");
              disableCheckNASWallet();
              return true;
            } else{
              toastBot.showToast('warning', "未检测到星云钱包插件, 请安装星云钱包插件!");
            }
            return false;
          });
        }
        return true;
      }

      function disableCheckNASWallet() {
        needCheckNASWallet = false;
        localStorage.setItem('needCheckNASWallet', 0);
        if(invoker != null){
          invoker.click();
        }
      }

      function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      var receiptGot = [];

      function getTransactionReceipt(hash, callback){
        $.post(rpcURL + '/v1/user/getTransactionReceipt', JSON.stringify({
          "hash": hash
        }), function (resp) {
          callback && callback(resp)
        })
      }

      function recheckTransactionReceipt(hash, callback) {
        var retry = 8;
        var retry2 = 32;
        var task = setInterval(function () {
          getTransactionReceipt(hash, function (resp) {
            retry --;
            if(retry < 0){

              try{
                neb.api.getTransactionReceipt({hash: hash}).then(function(receipt){
                  if (receipt.status == 0) //not in pending
                  {
                    clearInterval(task);
                    toastBot.showToast('error', "交易失败!");
                  } else if (receipt.status == 2) {
                    retry2 --;
                    if(retry2 < 0){
                      clearInterval(task);
                      toastBot.showToast('error', "查询交易状态超时, 请您手动查询交易!");
                    }
                  } else {
                    clearInterval(task);
                    callback && callback(resp.result);
                  }
                });
              } catch(err){
                console.log(err);
              }
            }
            var status = resp.result.status;
            if(status == 1){
              clearInterval(task);
              if(!receiptGot.includes(resp.result.hash)){
                receiptGot.push(resp.result.hash);
                callback && callback(resp.result);
              }
            }
          })
        }, 5000);
      }

      function innerCall(fun, args, value, callback, to) {
        let params = {};
        var account = Account.NewAccount();
        account.setPrivateKey(faucets[getRandomInt(0, 100)]);
        params.from = account;
        params.to = dappAddress;
        if(Account.isValidAddress(to)){
          params.to = to;
        }
        params.gasPrice = Utils.toBigNumber(1000000);
        params.gasLimit = Utils.toBigNumber(20000000);
        params.value = value;
        // prepare contract
        params.contract = {
          "function": fun,
          "args": JSON.stringify(args)
        };
//        console.log(params.from.getAddressString() + ' call ' + params.to + ' @ ' + fun + ": " + JSON.stringify(args) + ' with value: ' + value);
        callback(params);
      }

      window.mobileAndTabletcheck = function() {
        var check = false;
        (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);
        return check;
      };

      function refresh(){
        toastBot.showToast('info', "交易数据将在几秒内自动更新");
        address = localStorage.getItem('address') || '';
        load();
      }


      function getMobileTransactionReceipt(serialNumber, callback){
        $.get("https://pay.nebulas.io/api/mainnet/pay/query?payId=" + serialNumber, function (resp) {
          callback && callback(resp)
        })
      }

      var retryQueryTime = 10;

      function recheckMobileTransactionReceipt(serialNumber, callback) {
        retryQueryTime --;
        getMobileTransactionReceipt(serialNumber, function (resp) {
          if(resp instanceof Object){
            if(retryQueryTime <= 0){
              clearInterval(intervalQuery);
              if(resp.code == 1){
                clearInterval(intervalQuery);
                toastBot.showToast('error', "查询交易状态超时, 请您手动查询交易!");
                return;
              }
            }
            if (resp.code == 0 && (resp.data.status == 1 || resp.data.status == 0)) {
              clearInterval(intervalQuery);
              if(!receiptGot.includes(resp.data.hash)){
                receiptGot.push(resp.data.hash);
                callback && callback(resp.data);
              }
            }
          }

        })
      }

      var NebPay = require("nebpay");     //https://github.com/nebulasio/nebPay
      var nebPay = new NebPay();
      var intervalQuery;

      function callNebPay(fun, args, value, callback, to) {

        if(isWx){
          toastBot.showToast('error', "微信浏览器可能不支持NAS nano调用!");
        }

        var wait;
        function clearWait() {
          clearInterval(wait);
          refresh();
        }

        var inQuery = false;
        toastBot.showToast('info', "正在调用钱包!");
        var serialNumber;
        innerCall(fun, args, value, function (params) {
          serialNumber = nebPay.call(params.to, params.value, params.contract.function, params.contract.args, {
            qrcode: {
              showQRCode: false
            },
            callback:"https://pay.nebulas.io/api/mainnet/pay",
            listener: function (resp) {
              if(window.mobileAndTabletcheck()){
                if(!inQuery){
                  inQuery = true;
                  retryQueryTime = 10;
                  toastBot.showToast('info', "正在查询交易状态!");
                  intervalQuery = setInterval(function () {
                    recheckMobileTransactionReceipt(serialNumber, function(resp){
                      if(resp.status == 1){
                        toastBot.showToast('success', "交易成功!");
                        callback && callback(resp);
                      } else if(resp.status == 0){
                        toastBot.showToast('error', "交易失败! 错误提示: " + resp.execute_error);
                        wait = setInterval(clearWait, 2000);
                      }
                    });
                  }, 5000);
                }
                return;
              }
              if (resp !== 'Error: Transaction rejected by user') {
                toastBot.showToast('info', "交易已提交, 正在为您查询交易状态, 请等待约15秒钟!");
                var hash = resp.txhash;
                recheckTransactionReceipt(hash, function (resp) {
                  toastBot.showToast('success', "交易成功!");
                  callback && callback(resp);
                })
              } else {
                toastBot.showToast('warning', "您已取消!");
              }

            }
          });

          var wait2;
          function clearWait2() {
            clearInterval(wait2);
            if(window.mobileAndTabletcheck() && !inQuery){
              inQuery = true;
              retryQueryTime = 15;
              toastBot.showToast('info', "正在查询交易状态!");
              intervalQuery = setInterval(function () {
                recheckMobileTransactionReceipt(serialNumber, function(resp){
                  if(resp.status == 1){
                    toastBot.showToast('success', "交易成功!");
                    callback && callback(resp);
                  } else if(resp.status == 0){
                    toastBot.showToast('error', "交易失败! 错误提示: " + resp.execute_error);
                    wait = setInterval(clearWait, 2000);
                  }
                });
              }, 5000);
            }
          }
          wait2 = setInterval(clearWait2, 10000);

          var wait3;

          function clearWait3() {
            clearInterval(wait3);
            if (window.mobileAndTabletcheck() && inQuery) {
              toastBot.showToast('info', "正在查询交易状态!");
            }
          }

          wait3 = setInterval(clearWait3, 18000);

        }, to);
      }


      function checkWallet(){
        if (typeof (webExtensionWallet) === "undefined") {
          $(document).ready(function () {
            if(window.mobileAndTabletcheck()){
              if(Account.isValidAddress(address)){
                $(".network-state").html('已使用NAS nano登陆');
              } else{
                $(".network-state").removeClass('badge-success').addClass('badge-warning').html('请安装NAS nano');
              }
            } else{
              $(".network-state").removeClass('badge-success').addClass('badge-warning').html('未检测到星云插件钱包');
            }
          });
          return false;
        }
        $(".network-state").html('已安装星云插件钱包');
        return true;
      }

      var address = localStorage.getItem('address') || '';
      var addressWallet = '';
      var nasBalance = -1;
      var nttBalance = -1;

      function loadHolderAccount(){
        window.addEventListener('message', function (e) {
          if (e.data.data && !!e.data.data.account) {
            addressWallet = e.data.data.account;
            if(checkWallet()){
              address = addressWallet;
              localStorage.setItem('address', address);
            }
          }

          if(Account.isValidAddress(address)){
            try {
              neb.api.getAccountState(address).then(function(accstate){
                $(".accountBalance").html(' ' + Unit.fromBasic(accstate.balance, "nas").toFixed(2) + ' NAS');
                nasBalance = Unit.fromBasic(accstate.balance, "nas").toFixed(2);
                var fun = 'balanceOf';
                var args = [];

                args.push(address);
                innerCall(fun, args, 0, function(params){
                  neb.api.call(address, params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
                    var result = resp.result;
                    if(result === 'null' || result === '""'){
                      return;
                    }
                    try{
                      var balance = JSON.parse(result);
                      $(".accountTokenBalance").html(' ' + Unit.fromBasic(balance, "nas").toFixed(2) + ' NTT');
                      nttBalance = Unit.fromBasic(balance, "nas").toFixed(2);
                      var fun = 'getHolder';
                      var args = [];
                      args.push(address);
                      innerCall(fun, args, 0, function(params){
                        neb.api.call(address, params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
                          var result = resp.result;
                          if(result === 'null' || result === '""'){
                            return;
                          }

                          try{
                            var holder = JSON.parse(result);
                            if(holder.account !== ''){
                              if(holder.holderId >= 0){
                                // $(".avatarImg").prop('src', "assets/images/avatars/uifaces" + holder.holderId % 20 + ".jpg");
                                $(".user-name").html('星图用户 #' + holder.holderId);
                                //TODO calculate captital
//                                $("#capital").html(0);
                              } else{
                                // $(".avatarImg").prop('src', "assets/images/avatars/uifaces0.jpg");
                                $(".user-name").html('新用户');
                              }

                            } else {
                              $(".user-name").html('新用户');
                            }
                          }catch (err){
                            //result is the error message
                            console.log("error:" + err.message)
                          }
                        }).catch(function (err) {
                          console.log("error:" + err.message)
                        });

                      });

                    }catch (err){
                      //result is the error message
                      console.log("error:" + err.message)
                    }
                  }).catch(function (err) {
                    console.log("error:" + err.message)
                  });

                });

              })
            } catch (err){
              console.log(err);
            }
          }
        });
        window.postMessage({
          "target": "contentscript",
          "data": {},
          "method": "getAccount"
        }, "*");
      }

      function loadHolderNum(){
        var fun = 'holderNum';
        var args = [];
        innerCall(fun, args, 0, function(params){
          neb.api.call(params.from.getAddressString(), params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
            var result = resp.result;
            if(result === 'null' || result === '""'){
              return;
            }
            try{
                var holderNum = JSON.parse(result);
                $("#holderNum").html(holderNum);
            }catch (err){
              //result is the error message
              console.log("error:" + err.message)
            }
          }).catch(function (err) {
            console.log("error:" + err.message)
          });

        });
      }

      function loadTokenNum(){
        var fun = 'tokenNum';
        var args = [];
        innerCall(fun, args, 0, function(params){
          neb.api.call(params.from.getAddressString(), params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
            var result = resp.result;
            if(result === 'null' || result === '""'){
              return;
            }
            try{
              var tokenNum = JSON.parse(result);
              $("#tokenNum").html(tokenNum);
            }catch (err){
              //result is the error message
              console.log("error:" + err.message)
            }
          }).catch(function (err) {
            console.log("error:" + err.message)
          });

        });
      }

      var tokenBalances = {};
      var tokenCapital = {};
      var tokenInfo = {};

      function loadHolderTokenBalance(tokenId){
        var fun = 'balanceOf';
        var args = [];
        args.push(address);
        innerCall(fun, args, 0, function(params){
          neb.api.call(params.from.getAddressString(), params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
            var result = resp.result;
            if(result === 'null' || result === '""'){
              return;
            }
            try{
              var balance = JSON.parse(result);
              $("#balanceToken" + tokenId).html(Unit.fromBasic(balance).toFixed(2));
              tokenBalances[tokens[tokenId]] = Unit.fromBasic(balance).toFixed(2);
              var holdNum = 0;
              for(var i in tokenBalances){
                holdNum += tokenBalances[i] > 0 ? 1:0;
              }
              $("#ownToken").html(holdNum);
            }catch (err){
              //result is the error message
              console.log("error:" + err.message)
            }
          }).catch(function (err) {
            console.log("error:" + err.message)
          });

        }, tokens[tokenId]);
      }

      function loadToken(tokenId){
        var fun = 'getToken';
        var args = [];
        args.push(tokens[tokenId]);
        innerCall(fun, args, 0, function(params){
          neb.api.call(params.from.getAddressString(), params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
            var result = resp.result;
            if(result === 'null' || result === '""'){
              return;
            }
            try{
              var token = JSON.parse(result);
              $("#authToken" + tokenId).html(Unit.fromBasic(token.auth).toFixed(2));
              $("#popToken" + tokenId).html(Unit.fromBasic(token.popularity).toFixed(2));
              tokenInfo[token.address] = token;
            }catch (err){
              //result is the error message
              console.log("error:" + err.message)
            }
          }).catch(function (err) {
            console.log("error:" + err.message)
          });

        });
      }

      var tokens = ['n1sr4JA4e9QPB4opLk2Kjmp8NkP6GGoAmnt', 'n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr', 'n1gDfiiQLEBu95xDWHGxNi4qToyXjD2vE4D'];
      var decimals = {'n1sr4JA4e9QPB4opLk2Kjmp8NkP6GGoAmnt': 18, 'n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr': 18, 'n1gDfiiQLEBu95xDWHGxNi4qToyXjD2vE4D': 0};
      var type = {'n1sr4JA4e9QPB4opLk2Kjmp8NkP6GGoAmnt': 20, 'n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr': 20, 'n1gDfiiQLEBu95xDWHGxNi4qToyXjD2vE4D': 20};
      function loadTokens(){
        for(var i in tokens){
          loadToken(i);
          loadHolderTokenBalance(i);
        }
      }

      function closeAuth(){
        $("#authAccount").val('');
        $("#authAmount").val('');
        $("#confirmAuth").attr('disabled', true);
      }

      function closePop(){
        $("#popAccount").val('');
        $("#popAmount").val('');
        $("#confirmPop").attr('disabled', true);
      }

      function closeTransfer(){
        $("#receiverAccount").val('');
        $("#transferAmount").val('');
        $("#alias").html('');
      }

      var selectedToken = '';
      var authOld = 0;
      var popOld = 0;
      var useAlais = false;

      function authDialog(_address){
        selectedToken = _address;
        $("#form-auth").modal('show');
        $("#token").html('站台');

        var fun = 'authority';
        var args = [];
        args.push(address);
        args.push(selectedToken);
        innerCall(fun, args, 0, function(params){
          neb.api.call(address, params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
            var result = resp.result;
            if(result === 'null' || result === '""'){
              return;
            }
            try{
              var authority = JSON.parse(result);
              authOld = Unit.fromBasic(authority).toFixed(6);
              $("#authAmount").val(authOld);
              $("#confirmAuth").attr('disabled', false);
            }catch (err){
              //result is the error message
              console.log("error:" + err.message)
            }
          }).catch(function (err) {
            console.log("error:" + err.message)
          });

        });

      }

      function popDialog(_address){
        selectedToken = _address;
        $("#form-pop").modal('show');
        $("#token").html('站台');
        var fun = 'popularity';
        var args = [];
        args.push(address);
        args.push(selectedToken);
        innerCall(fun, args, 0, function(params){
          neb.api.call(address, params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
            var result = resp.result;
            if(result === 'null' || result === '""'){
              return;
            }
            try{
              var popularity = JSON.parse(result);
              popOld = Unit.fromBasic(popularity).toFixed(6);
              $("#popAmount").val(popOld);
              $("#confirmPop").attr('disabled', false);
            }catch (err){
              //result is the error message
              console.log("error:" + err.message)
            }
          }).catch(function (err) {
            console.log("error:" + err.message)
          });

        });
      }

      function transferDialog(_address){
        selectedToken = _address;
        $("#form-transfer").modal('show');
        $("#token").html('转账');
        var wait;
        var input = 'orange';
        var i = 0;
        function clearWait(){
          clearInterval(wait);
          i++;
          $("#receiverAccount").val(input.substr(0, i));
          getAliasAccount();
          if(i < input.length)
            wait = setInterval(clearWait, 200);
        }
        if(!leaded){
          leaded = 1;
          wait = setInterval(clearWait, 200);
        }
      }

      function auth(){
        if (checkNASWallet()) {
          var authAmount = $("#authAmount").val();
          // TODO get decimals from token info
          var decimals = 18;
          var amount = new BigNumber(authAmount);

          if(amount < 0  || authAmount === ''){
            toastBot.showToast('warning', "您输入的数量有误, 请重新输入!");
            return;
          }

          if(amount.gt(parseFloat(nttBalance) + parseFloat(authOld)) && nttBalance >= 0){
            toastBot.showToast('warning', "您的最大站台数量为: " + (parseFloat(nttBalance) + parseFloat(authOld)));
            return;
          }

          $("#form-auth").modal('hide');
          var fun = 'authorize';
          var args = [];
          args.push(selectedToken);
          args.push(amount);
          closeAuth();
          callNebPay(fun, args, 0, function (resp) {
            localStorage.setItem('address', resp.from);
            var wait;
            function clearWait() {
              clearInterval(wait);
              refresh();
            }
            wait = setInterval(clearWait, 2000);
          });
        }
      }

      function pop(){
        if (checkNASWallet()) {
          var popAmount = $("#popAmount").val();
          // TODO get decimals from token info
          var decimals = 18;
          var amount = new BigNumber(popAmount);

          if(amount < 0 || popAmount === ''){
            toastBot.showToast('warning', "您输入的数量有误, 请重新输入!");
            return;
          }

          if(amount.gt(parseFloat(nttBalance) + parseFloat(popOld)) && nttBalance >= 0){
            toastBot.showToast('warning', "您的最大支持数量为: " + (parseFloat(nttBalance) + parseFloat(popOld)));
            return;
          }

          $("#form-pop").modal('hide');
          var fun = 'popularize';
          var args = [];
          args.push(selectedToken);
          args.push(amount);
          closePop();
          callNebPay(fun, args, 0, function (resp) {
            localStorage.setItem('address', resp.from);
            var wait;
            function clearWait() {
              clearInterval(wait);
              refresh();
            }
            wait = setInterval(clearWait, 2000);
          });
        }
      }


      function transfer(){
        if (checkNASWallet()) {
          var receiver = $("#receiverAccount").val();
          var transferAmount = $("#transferAmount").val();
          var amount = parseFloat(transferAmount);
          if(amount < 0 || transferAmount === ''){
            toastBot.showToast('warning', "您输入的数量有误, 请重新输入!");
            return;
          }
          if(amount > parseFloat(tokenBalances[selectedToken])){
            toastBot.showToast('warning', "您的最大转账数量为: " + tokenBalances[selectedToken]);
            return;
          }
          // TODO get decimals from token info
          var decimal = decimals[selectedToken];
          amount = new BigNumber(amount).mul(new BigNumber(10).pow(decimal));
          if(!Account.isValidAddress(receiver) && !useAlais){
            toastBot.showToast('warning', "您输入的账户地址有误, 请重新输入!");
            return;
          }
          if(useAlais) receiver = $("#alias").html();
          $("#form-transfer").modal('hide');
          var fun = 'transfer';
          var args = [];
          args.push(receiver);
          args.push(amount);
          closeTransfer();
          callNebPay(fun, args, 0, function (resp) {
            localStorage.setItem('address', resp.from);
            var wait;
            function clearWait() {
              clearInterval(wait);
              refresh();
            }
            wait = setInterval(clearWait, 2000);
          }, selectedToken);
        }
      }


      function validateAlias(alias){
        if (!alias || alias === "") {
          return false;
        }

        if (alias.length > 64) {
          return false;
        }

        if (!/^[a-zA-Z0-9_\-.]+$/.test(alias)) {
          return false;
        }
        return true;
      }

      function getAlias(alias){
        var aliasContractAddress = "n1kzpjFz4Xcn49bL8ey2RsvsaAZ1HCcEFug";
        var fun = 'getAddressForAlias';
        var args = [];
        args.push(alias);
        innerCall(fun, args, 0, function(params){
          neb.api.call(params.from.getAddressString(), params.to, params.value, 0, params.gasPrice, params.gasLimit, params.contract).then(function (resp) {
            var result = resp.result;
            if(result === 'null' || result === '""'){
              return;
            }
            try{
              var address = JSON.parse(result);
              useAlais = true;
              $("#alias").html(address);
            }catch (err){
              //result is the error message
              console.log("error:" + err.message)
            }
          }).catch(function (err) {
            console.log("error:" + err.message)
          });

        }, aliasContractAddress);
      }

      function setLoginAccount(){
        if(Account.isValidAddress($("#loginAccountAddress").val())){
          loadHolderAccount();
          address = $("#loginAccountAddress").val();
          localStorage.setItem('address', address);
          $("#form-login").modal('hide');
          toastBot.showToast('success', "您的账户登陆成功!");
        } else{
          toastBot.showToast('warning', "您输入的账户地址有误, 请重新输入!");
        }
      }

      function login(check){
        if(!checkWallet() && check){
          $("#form-login").modal('show');
          $("#loginAccountAddress").val(address);
        } else {
          if (checkNASWallet()) {
            var fun = 'login';
            var args = [];
            callNebPay(fun, args, 0, function (resp) {
              localStorage.setItem('address', resp.from);
              var wait;
              function clearWait() {
                clearInterval(wait);
                refresh();
              }
              wait = setInterval(clearWait, 2000);
            });
          }
        }
      }

      var isWx = Boolean(navigator.userAgent.match(/MicroMessenger/ig));
      if(isWx){
        toastBot.init();
        toastBot.showToast('warning', "微信浏览器可能不支持NAS nano调用!");
      }

      function loadCapital(){
        var wait = function(){
          for(var i in tokens){
            if(typeof tokenBalances[tokens[i]] === 'undefined' || typeof tokenInfo[tokens[i]] === 'undefined'){
//              return;
              continue;
            } else {
              tokenCapital[tokens[i]] = tokenBalances[tokens[i]] * tokenInfo[tokens[i]].price.NAS;
            }
          }

          var capital = 0;
          for(var i in tokenCapital){
            capital += tokenCapital[i];
          }
          console.log(tokenCapital);
          $("#capital").html(capital.toFixed(2));
//          clearInterval(interval);
        };

        var interval = setInterval(wait, 1000);

      }

      function load(){
        checkWallet();
        loadHolderAccount();
        loadTokens();
        loadHolderNum();
        loadTokenNum();
        loadCapital();
      }

      load();
//      var interval;

      var roundIcon = document.getElementById('roundIcon');
      if(Account.isValidAddress(address)){
        roundIcon.style.backgroundImage = 'url(' + hqx(blockies.create({ seed:address ,size: 8,scale: 1}),4).toDataURL()+')';
      } else {
        roundIcon.style.backgroundImage = 'url(' + hqx(blockies.create({ seed:dappAddress ,size: 8,scale: 1}),4).toDataURL()+')';
      }

    </script>
  </body>


  <div id="form-login" class="modal fade colored-header colored-header-primary" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">请输入您的账户地址</h4>
        </div>
        <div class="modal-body">
          <label>账户地址</label>
          <input type="text" class="form-control input-group-sm" id="loginAccountAddress">
        </div>
        <div class="modal-footer"  style="padding-top: 10px">
          <br>
          <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
          <button type="button" class="btn btn-primary" onclick="setLoginAccount()">确定</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->


  <div id="form-transfer" class="modal fade colored-header colored-header-primary" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="token">转账</h4>
        </div>
        <div class="modal-body">
          <label>接收地址</label><span class="badge badge-pill badge-light" id="alias"></span>
          <input type="text" class="form-control input-sm" id="receiverAccount" placeholder="星云地址或nas.me代号">
          <label>数量</label>
          <input type="number" class="form-control input-sm" id="transferAmount">
        </div>
        <div class="modal-footer"  style="padding-top: 10px">
          <br>
          <button type="button" class="btn btn-default" data-dismiss="modal" onclick="closeTransfer()">关闭</button>
          <button type="button" class="btn btn-primary" onclick="transfer()">确定</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->

  <div id="form-auth" class="modal fade colored-header colored-header-primary" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">站台</h4>
        </div>
        <div class="modal-body">
          <label>数量</label>
          <input type="number" class="form-control input-sm" id="authAmount">
        </div>
        <div class="modal-footer"  style="padding-top: 10px">
          <br>
          <button type="button" class="btn btn-default" data-dismiss="modal" onclick="closeAuth()">关闭</button>
          <button type="button" class="btn btn-primary" onclick="auth()" disabled="disabled" id="confirmAuth">确定</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->

  <div id="form-pop" class="modal fade colored-header colored-header-primary" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">支持</h4>
        </div>
        <div class="modal-body">
          <label>数量</label>
          <input type="number" class="form-control input-sm" id="popAmount">
        </div>
        <div class="modal-footer"  style="padding-top: 10px">
          <br>
          <button type="button" class="btn btn-default" data-dismiss="modal" onclick="closePop()">关闭</button>
          <button type="button" class="btn btn-primary" onclick="pop()" disabled="disabled" id="confirmPop">确定</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->

  <div id="form-lead" class="modal fade colored-header colored-header-primary" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">介绍</h4>
        </div>
        <div class="modal-body">
          <p>星图——星云上最好的代币钱包。注册前1000名有星图币（NTT）糖果，按照阶梯递减的方式免费发放。为了遴选优秀的代币，星图用户可以使用星图币来站台和支持其他代币进行社区治理和社区共建。站台是权威度，支持是流行度；站台主要是项目方给自己的代币站台，支持主要是来自社区的支持。星图具有方便的代币转账功能。</p>

        </div>
        <div class="modal-footer"  style="padding-top: 10px">
          <br>
          <button type="button" class="btn btn-default" data-dismiss="modal" onclick="transferDialog('n1kVKK53C85Cu6PBkgE8Qvch9ym5GxnDSWr')">关闭</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->

  <script>

    function getAliasAccount(){
      var receiver = $("#receiverAccount").val();
      if(!Account.isValidAddress(receiver) && validateAlias(receiver)){
        $("#alias").html('');
        useAlais = false;
        getAlias(receiver);
      }else{
        useAlais = false;
        $("#alias").html('')
      }
    }

    $("#receiverAccount").on('input', function (e) {
      getAliasAccount();
    });

    var leaded = localStorage.getItem('leaded') || "0";
    leaded = parseInt(leaded);
    function lead(){
      if(!leaded){
        localStorage.setItem('leaded', 1);
        $("#form-lead").modal('show');
      }
    }
    lead();
  </script>
</html>